# 更新日誌

此專案的所有重要變更都會記錄在這個檔案中。

格式基於 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)，
此專案遵循 [語意化版本](https://semver.org/spec/v2.0.0.html)。

## 未發布 - 2025-07-17 [9c372b](https://github.com/tommot20077/trading-chart/commit/9c372bd52d2fc6a2ef6118e2e08a478ce4e548e9)

### 新增功能
- **依賴項審查工作流程**：新增 GitHub Actions 依賴項安全性和授權審查工作流程
- **完整核心系統實作**：使用 memory 和 noop 提供者完整實作所有核心介面
- **認證系統**：完整的記憶體內認證系統，具備使用者管理、密碼雜湊和令牌驗證
- **事件處理系統**：事件匯流排、序列化和中介軟體管道，具備完整事件處理功能
- **儲存系統**：時序資料庫、事件儲存和元資料管理，具備完整 CRUD 操作
- **中介軟體管道**：請求/回應中介軟體系統，具備上下文傳播和錯誤處理
- **可觀測性系統**：通知處理和監控功能
- **速率限制**：記憶體內速率限制，具備可配置策略
- **全面測試覆蓋**：為所有元件新增單元、整合和契約測試
- **型別安全**：完整的 MyPy 整合，在所有模組中實行嚴格型別檢查

### 變更
- **Python 版本支援**：從 Python 3.10-3.13 更新為 3.11-3.13 支援
- **專案結構**：將處理器註冊表從介面移至元件套件
- **例外處理**：增強例外階層，具備特定事件和儲存例外
- **測試配置**：新增 pytest-timeout 和增強測試標記，改善測試組織
- **CI/CD 管道**：更新 GitHub Actions 以支援 Python 3.11-3.13 版本

### 移除
- **AI 文件**：移除 ai-docs/SUMMARY.md 和 ai-docs/WORKFLOWS.md 檔案
- **基準目錄**：移除 benchmarks/baselines 目錄結構
- **Python 3.10 支援**：捨棄 Python 3.10 支援，改用較新版本

### 修復
- **型別檢查**：解決型別註解問題，使用 disable_error_code 處理未檢查的註解
- **測試超時**：為並發測試新增適當的超時處理
- **格式檢查**：修復 poethepoet 配置中的格式檢查命令

### 重大變更
- **最低 Python 版本**：現在需要 Python 3.11 或更高版本
- **架構**：核心實作完全重構，具備新的介面契約
- **認證**：新的認證系統需要基於令牌的認證
- **事件系統**：具備中介軟體支援的新事件處理架構

### 效能改善
- **記憶體管理**：最佳化記憶體內實作，具備更好的資料結構
- **事件處理**：高效的事件序列化和反序列化
- **速率限制**：高效能記憶體內速率限制，具備最小開銷
- **並發操作**：所有核心元件的執行緒安全實作

### 文件
- **契約測試**：新增完整的契約測試文件
- **整合測試**：增強整合測試覆蓋，具備真實世界情境
- **API 文件**：所有新介面和實作的完整 API 文件

---

## 未發布 - 2025-07-15 [864bf9](https://github.com/tommot20077/trading-chart/commit/864bf9df6d2bdbd54432e36ea14c49127af2ed8a)

### 新增功能
- **認證系統**：完整的認證介面，包含認證器、授權器和令牌管理器
- **資料模型**：完整的交易系統資料模型（K線、交易、基礎事件）
- **事件系統**：完整的事件架構，具備優先級處理和儲存功能
- **儲存介面**：時序資料庫介面，採用通用資料庫模式
- **網路模型**：網路相關的列舉和模型，用於系統通訊
- **例外處理**：完整的例外階層，用於錯誤管理
- **資料驗證**：強健的資料驗證，整合 Pydantic
- **型別安全**：完整的 MyPy 型別檢查整合
- **Github Actions CI/CD**：完整的 CI/CD 流程，包含自動化測試

### 變更
- **架構設計**：從簡單配置演進為完整的交易系統架構
- **資料層**：引入具備驗證和序列化功能的精密資料模型
- **事件系統**：實作優先級事件處理與訂閱管理
- **儲存層**：新增時序資料管理的通用資料庫模式

### 修復
- **EventPriority 型別安全**：修復 EventPriority 與 Pydantic 之間的型別相容性問題
- **方法簽名**：解決資料庫繼承中的方法簽名衝突
- **型別註解**：新增缺少的返回型別註解以確保完整型別安全
- **資料驗證**：修復時區處理和價格/成交量驗證邊界情況

### 重大變更
- **架構轉變**：從簡單配置轉向完整的交易系統架構
- **資料模型**：引入具備 Pydantic 模型的嚴格資料驗證
- **事件系統**：實作具備優先級處理的新事件驅動架構
- **儲存層**：新增需要介面實作的資料庫模式

### 效能改善
- **資料驗證**：高效的 Pydantic 驗證，具備欄位級最佳化
- **事件處理**：優先級事件處理，具備 O(log n) 複雜度
- **型別檢查**：完整的 MyPy 整合，零型別錯誤
- **記憶體使用**：最佳化物件建立和記憶體占用

### 文件
- 新增所有核心介面的完整 API 文件
- 記錄資料模型架構和驗證規則
- 增強事件系統架構文件
- 新增儲存介面使用範例
- 更新開發工作流程，包含新架構模式

---

## 未發布 - 2025-07-14 [127ea7](https://github.com/tommot20077/trading-chart/commit/127ea7d92325975dd0b14f8372e9bdc48685348c)

### 初始化
- 使用 monorepo 架構的初始專案設定
- 具備 BaseCoreSettings 的核心配置系統
- 四層架構（Core、Libs、Integrations、Apps）
- 完整測試策略（單元、整合、端對端）
- 使用 uv 套件管理器的開發工具
- 程式碼品質工具（ruff、mypy、pytest）
- 相依性注入框架設定

### 新增功能
- **強化配置驗證器**：為 ENV、LOG_LEVEL、LOG_FORMAT 和 TIMEZONE 欄位新增大小寫不敏感的驗證器
- **環境別名支援**：支援常用環境別名（dev→development、prod→production、stage→staging）
- **TIMEZONE 驗證**：使用 Python zoneinfo 模組進行完整的 IANA 時區驗證，包含大小寫標準化
- **專業效能測試**：以 pytest-benchmark 框架取代自製效能測試
- **完整測試套件**：新增驗證器與設定效能的完整測試套件
- **效能測試腳本**：包含具備基線比較功能的效能測試腳本
- **文件更新**：增強專案文件，加入效能測試工作流程
- **多語言文件**：新增繁體中文文件支援

### 變更
- **效能測試框架**：從自製時間測量遷移至 pytest-benchmark，提供精確的效能分析
- **配置驗證**：增強驗證邏輯，提供更好的錯誤訊息和大小寫處理
- **測試結構**：重新組織測試結構，在單元測試和整合測試之外加入效能測試

### 修復
- **測試隔離**：修復效能測試中與快取相關的測試隔離問題
- **TIMEZONE 大小寫處理**：改善時區驗證以正確處理各種大小寫格式

### 重大變更
- **TIMEZONE 驗證**：TIMEZONE 欄位現在嚴格驗證 IANA 時區資料庫。無效的時區字串將引發驗證錯誤。

### 效能改善
- **單例存取**：設定單例存取最佳化至 ~77ns（每秒 1300 萬次操作）
- **驗證器效能**：大部分驗證器效能為 ~400μs（每秒 2500 次操作）
- **物件建立**：完整設定物件建立為 ~450μs（每秒 2200 次操作）

### 文件
- 新增完整的效能測試指南
- 更新開發工作流程，包含效能測試程序
- 增強專案摘要，加入效能測試資訊
- 新增繁體中文文件

### 技術細節
- **相依性**：新增 pytest-benchmark 和 psutil 用於效能測試
- **測試覆蓋率**：在所有層級維持 80%+ 的測試覆蓋率
- **程式碼品質**：所有變更皆通過 ruff、mypy 和 pytest 品質檢查
- **架構**：維持清晰架構原則，具備適當的層級分離