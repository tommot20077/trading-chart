# 更新日誌

此專案的所有重要變更都會記錄在這個檔案中。

格式基於 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)，
此專案遵循 [語意化版本](https://semver.org/spec/v2.0.0.html)。

## 未發布 - 2025-07-15

### 新增功能
- **核心架構基礎**：建立完整的核心模型架構，包含 9000+ 行程式碼
- **認證系統**：完整的認證介面，包含認證器、授權器和令牌管理器
- **資料模型**：完整的交易系統資料模型（K線、交易、基礎事件）
- **事件系統**：完整的事件架構，具備優先級處理和儲存功能
- **儲存介面**：時序資料庫介面，採用通用資料庫模式
- **網路模型**：網路相關的列舉和模型，用於系統通訊
- **例外處理**：完整的例外階層，用於錯誤管理
- **資料驗證**：強健的資料驗證，整合 Pydantic
- **型別安全**：完整的 MyPy 型別檢查整合
- **Github Actions CI/CD**：完整的 CI/CD 流程，包含自動化測試

### 變更
- **架構設計**：從簡單配置演進為完整的交易系統架構
- **資料層**：引入具備驗證和序列化功能的精密資料模型
- **事件系統**：實作優先級事件處理與訂閱管理
- **儲存層**：新增時序資料管理的通用資料庫模式

### 修復
- **EventPriority 型別安全**：修復 EventPriority 與 Pydantic 之間的型別相容性問題
- **方法簽名**：解決資料庫繼承中的方法簽名衝突
- **型別註解**：新增缺少的返回型別註解以確保完整型別安全
- **資料驗證**：修復時區處理和價格/成交量驗證邊界情況

### 重大變更
- **架構轉變**：從簡單配置轉向完整的交易系統架構
- **資料模型**：引入具備 Pydantic 模型的嚴格資料驗證
- **事件系統**：實作具備優先級處理的新事件驅動架構
- **儲存層**：新增需要介面實作的資料庫模式

### 效能改善
- **資料驗證**：高效的 Pydantic 驗證，具備欄位級最佳化
- **事件處理**：優先級事件處理，具備 O(log n) 複雜度
- **型別檢查**：完整的 MyPy 整合，零型別錯誤
- **記憶體使用**：最佳化物件建立和記憶體占用

### 文件
- 新增所有核心介面的完整 API 文件
- 記錄資料模型架構和驗證規則
- 增強事件系統架構文件
- 新增儲存介面使用範例
- 更新開發工作流程，包含新架構模式

---

## 未發布 - 2025-07-14

### 初始化
- 使用 monorepo 架構的初始專案設定
- 具備 BaseCoreSettings 的核心配置系統
- 四層架構（Core、Libs、Integrations、Apps）
- 完整測試策略（單元、整合、端對端）
- 使用 uv 套件管理器的開發工具
- 程式碼品質工具（ruff、mypy、pytest）
- 相依性注入框架設定

### 新增功能
- **強化配置驗證器**：為 ENV、LOG_LEVEL、LOG_FORMAT 和 TIMEZONE 欄位新增大小寫不敏感的驗證器
- **環境別名支援**：支援常用環境別名（dev→development、prod→production、stage→staging）
- **TIMEZONE 驗證**：使用 Python zoneinfo 模組進行完整的 IANA 時區驗證，包含大小寫標準化
- **專業效能測試**：以 pytest-benchmark 框架取代自製效能測試
- **完整測試套件**：新增驗證器與設定效能的完整測試套件
- **效能測試腳本**：包含具備基線比較功能的效能測試腳本
- **文件更新**：增強專案文件，加入效能測試工作流程
- **多語言文件**：新增繁體中文文件支援

### 變更
- **效能測試框架**：從自製時間測量遷移至 pytest-benchmark，提供精確的效能分析
- **配置驗證**：增強驗證邏輯，提供更好的錯誤訊息和大小寫處理
- **測試結構**：重新組織測試結構，在單元測試和整合測試之外加入效能測試

### 修復
- **測試隔離**：修復效能測試中與快取相關的測試隔離問題
- **TIMEZONE 大小寫處理**：改善時區驗證以正確處理各種大小寫格式

### 重大變更
- **TIMEZONE 驗證**：TIMEZONE 欄位現在嚴格驗證 IANA 時區資料庫。無效的時區字串將引發驗證錯誤。

### 效能改善
- **單例存取**：設定單例存取最佳化至 ~77ns（每秒 1300 萬次操作）
- **驗證器效能**：大部分驗證器效能為 ~400μs（每秒 2500 次操作）
- **物件建立**：完整設定物件建立為 ~450μs（每秒 2200 次操作）

### 文件
- 新增完整的效能測試指南
- 更新開發工作流程，包含效能測試程序
- 增強專案摘要，加入效能測試資訊
- 新增繁體中文文件

### 技術細節
- **相依性**：新增 pytest-benchmark 和 psutil 用於效能測試
- **測試覆蓋率**：在所有層級維持 80%+ 的測試覆蓋率
- **程式碼品質**：所有變更皆通過 ruff、mypy 和 pytest 品質檢查
- **架構**：維持清晰架構原則，具備適當的層級分離